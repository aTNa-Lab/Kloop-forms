(this["webpackJsonpkloop-forms"]=this["webpackJsonpkloop-forms"]||[]).push([[0],{119:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(10),l=n.n(o),s=(n(92),n(51)),i=n(52),c=n(58),u=n(57),m=(n(60),n(59)),d=n(11),f=n(35),p=n(17),w=n(62),h=n.n(w);h.a.initializeApp({apiKey:"AIzaSyDRhaklmVogc4wWVlf6MWMUS0gpMccfn0I",authDomain:"atna-lab.firebaseapp.com",databaseURL:"https://atna-lab.firebaseio.com",projectId:"atna-lab",storageBucket:"atna-lab.appspot.com",messagingSenderId:"436661740234",appId:"1:436661740234:web:8baf6f9f6c2c845d828a33",measurementId:"G-LF9JG7V3D4"});var b=h.a,v=n(149),E=n(160),g=Object(v.a)((function(e){return{root:{"& > *":{width:"40ch"}}}}));var k=function(e){var t=g(),n=r.a.useState(""),o=Object(p.a)(n,2),l=o[0],s=o[1],i=e.index,c=e.response;return Object(a.useEffect)((function(){c&&s(c)}),[c]),r.a.createElement("div",null,r.a.createElement("form",{noValidate:!0,autoComplete:"off"},r.a.createElement("h4",null,e.title),r.a.createElement(E.a,{className:t.root,id:"inputBox"+i,label:"\u041c\u043e\u0439 \u043e\u0442\u0432\u0435\u0442",value:l,onChange:function(t){s(t.target.value),e.returnAnswer(t.target.value,i,t.target.value)},disabled:!!e.locked})))},O=n(161),y=n(162),A=n(155),j=n(156),S=Object(v.a)((function(e){return{formControl:{minWidth:120}}}));function x(e){var t=S(),n=r.a.useState(""),o=Object(p.a)(n,2),l=o[0],s=o[1],i=r.a.useState(!1),c=Object(p.a)(i,2),u=c[0],m=c[1],d=e.index,f=e.response;Object(a.useEffect)((function(){f&&s(f)}),[f]);return r.a.createElement("div",null,r.a.createElement("h4",null,e.title),r.a.createElement(A.a,{className:t.formControl,disabled:!!e.locked},r.a.createElement(O.a,{id:"controlled-open-select-label"},"\u0412\u044b\u0431\u0440\u0430\u0442\u044c"),r.a.createElement(j.a,{labelId:"controlled-open-select-label",id:"select"+d,open:u,onClose:function(e){m(!1)},onOpen:function(e){m(!0)},value:l,onChange:function(t){s(t.target.value);var n=e.answers.indexOf(t.target.value);e.returnAnswer(t.target.value,d,n)}},r.a.createElement(y.a,{value:""},r.a.createElement("em",null,"None")),e.answers.map((function(e,t){return r.a.createElement(y.a,{key:t,value:e},e)})))))}var N=n(157),R=n(159),C=n(163);function D(e){var t=r.a.useState(""),n=Object(p.a)(t,2),o=n[0],l=n[1],s=e.index,i=e.response;Object(a.useEffect)((function(){i&&l(i)}),[i]);return r.a.createElement("div",null,r.a.createElement("h4",null,e.title),r.a.createElement(A.a,{const:"fieldset"},r.a.createElement(R.a,{"aria-label":e.title,name:e.title,value:o,onChange:function(t){l(t.target.value);var n=e.answers.indexOf(t.target.value);e.returnAnswer(t.target.value,s,n)}},e.answers.map((function(t,n){return r.a.createElement(C.a,{key:n,value:t,control:r.a.createElement(N.a,null),label:t,disabled:!!e.locked})})))))}var _=Object(v.a)((function(e){return{container:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:"auto"}}}));function q(e){var t=_(),n=r.a.useState(""),o=Object(p.a)(n,2),l=o[0],s=o[1],i=e.index,c=e.response;Object(a.useEffect)((function(){c&&s(c)}),[i,c]);return r.a.createElement("div",null,r.a.createElement("h4",null,e.title),r.a.createElement("form",{className:t.container,noValidate:!0},r.a.createElement(E.a,{id:"time"+i,label:"\u0412\u0440\u0435\u043c\u044f",type:"time",value:l,onChange:function(t){s(t.target.value),e.returnAnswer(t.target.value,i,t.target.value)},className:t.textField,InputLabelProps:{shrink:!0},InputProps:{disableUnderline:!0},disabled:!!e.locked})))}function I(e){var t=Object(a.useState)({}),n=Object(p.a)(t,2),o=n[0],l=n[1],s=Object(a.useState)({}),i=Object(p.a)(s,2),c=i[0],u=i[1],m={},d={},w=e.index,h=e.response;Object(a.useEffect)((function(){h&&l(h)}),[h]);var b=function(t){return function(n){(m=Object(f.a)({},o))[t]=n.target.value,l(m),d=Object(f.a)({},c);var a=e.answers.indexOf(n.target.value);d[t]=a,u(d),e.returnAnswer(m,w,d)}};return r.a.createElement("div",{className:"radioHorizontal"},r.a.createElement("h4",null,e.title),r.a.createElement("button",{onClick:function(){l({}),e.returnAnswer({},w)}},"clear"),r.a.createElement("div",{className:"question_item"},e.subquestion.map((function(t,n){return r.a.createElement("div",{className:"question_item_",key:n},r.a.createElement("p",null,t),r.a.createElement(A.a,{component:"fieldset",className:"question_item__answer"},r.a.createElement(R.a,{"aria-label":"position",name:"position",className:"question_item__answer_",value:o[n]?o[n]:"",onClick:b(n)},e.answers.map((function(t,a){return r.a.createElement(C.a,{key:a,value:t,control:r.a.createElement(N.a,{color:"primary"}),label:n>0?"":t,labelPlacement:"top",disabled:!!e.locked})})))))}))))}var L=n(70),M=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={questions:[],main_title:"",gateway:"",answers:{},shortAnswers:{},showAnswers:!1,response:{},period:null,locked:!1},e.rootRef=b.database().ref().child("RE:Message"),e.textRef=e.rootRef.child("d1"),e.downloadData=function(){var t=L.parse(window.location.search,{decode:!1});e.props.url?fetch(e.props.url).then((function(e){return console.log("RESPONSE",e),e.json()})).then((function(n){console.log("DATA",n),e.setState({questions:n.questions,main_title:n.main_title,gateway:n.gateway,period:n.period}),t.response&&e.initResponse(n,t),n.period&&e.timeManager(n)})):console.log("ERROR: no url detected")},e.uploadData=function(t){fetch(e.state.gateway,{method:"POST",mode:"no-cors",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return console.log(e)})).catch((function(t){console.log("Error",t),e.setState({showAnswers:!0})}))},e.timeManager=function(t){var n=new Date,a=new Date(t.period.start),r=new Date(t.period.finish);console.log(n,a,r),a>n&&t.period.before.nofill||a<n&&n<r&&t.period.in.nofill||n>r&&t.period.after.nofill?e.setState({locked:!0}):e.setState({locked:!1}),console.log("LOCKED ",e.state.locked)},e.initResponse=function(t,n){var a=decodeURI(n.response),r=JSON.parse(a);console.log(r),e.setState({response:r});for(var o=0,l=Object.entries(r);o<l.length;o++){var s=Object(p.a)(l[o],2),i=s[0],c=s[1],u=null;if(i===Object.keys(r)[0]&&e.returnAnswer(c,i),"input"===t.questions[i].type)e.returnAnswer(c,i);else if("time"===t.questions[i].type)e.returnAnswer(c,i,c);else if("multiradio"===t.questions[i].type)for(var m=0,d=Object.entries(c);m<d.length;m++){var w=Object(p.a)(d[m],2),h=w[0],b=w[1],v=t.questions[i].answer.indexOf(b),E=Object(f.a)({},e.state.shortAnswers[i]);E[h]=v,e.returnAnswer(c,i,E)}else u=t.questions[i].answer.indexOf(c),e.returnAnswer(c,i,u)}},e.returnAnswer=function(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=Object(f.a)({},e.state.answers);r[n]=t,e.setState({answers:r});var o=Object(f.a)({},e.state.shortAnswers);o[n]=a,e.setState({shortAnswers:o})},e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.downloadData(),this.textRef.push("nice to meet you")}},{key:"render",value:function(){var e=this,t=this.state.questions.map((function(t,n){var a=e.state.response;return"input"===t.type?r.a.createElement(k,{key:n,index:n,title:t.title,response:a[n],returnAnswer:e.returnAnswer,locked:e.state.locked}):"select"===t.type?r.a.createElement(x,{key:n,index:n,title:t.title,response:a[n],answers:t.answer,returnAnswer:e.returnAnswer,locked:e.state.locked}):"radio"===t.type?r.a.createElement(D,{key:n,index:n,title:t.title,response:a[n],answers:t.answer,returnAnswer:e.returnAnswer,locked:e.state.locked}):"time"===t.type?r.a.createElement(q,{key:n,index:n,title:t.title,response:a[n],returnAnswer:e.returnAnswer,locked:e.state.locked}):"multiradio"===t.type?r.a.createElement(I,{key:n,index:n,title:t.title,response:a[n],subquestion:t.subquestion,answers:t.answer,returnAnswer:e.returnAnswer,locked:e.state.locked}):null}));return r.a.createElement("div",null,r.a.createElement("h1",{className:"text-align-center"},this.state.main_title),t,r.a.createElement("div",{style:{paddingTop:20,paddingBottom:20,textAlign:"center"}},r.a.createElement("button",{disabled:!!this.state.locked,onClick:function(){return e.uploadData({a:"HELLo"})}},"Send data"),this.state.showAnswers?r.a.createElement("p",{style:{textAlign:"left"}},"Full answers: ",JSON.stringify(this.state.answers)):null,this.state.showAnswers?r.a.createElement("p",{style:{textAlign:"left"}},"Short answers: ",JSON.stringify(this.state.shortAnswers)):null))}}]),n}(a.Component),T=n(70),B=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).state={forms:[],mainUrl:""},e.downloadData=function(){var t=T.parse(window.location.search);console.log(t),t.url?fetch(t.url).then((function(e){return console.log("RESPONSE",e),e.json()})).then((function(n){console.log("DATA",n),e.setState({forms:n,mainUrl:t.url})})):console.log("ERROR: no url detected")},e.Home=function(){return r.a.createElement("h2",null,"Home")},e.FormA=function(){return r.a.createElement(M,{url:"https://raw.githubusercontent.com/aTNa-Lab/kloop-forms-config/master/form_A.json"})},e.FormB=function(){return r.a.createElement(M,{url:"https://raw.githubusercontent.com/aTNa-Lab/kloop-forms-config/master/form_B.json"})},e.FormC=function(){return r.a.createElement(M,{url:"https://raw.githubusercontent.com/aTNa-Lab/kloop-forms-config/master/form_C.json"})},e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.downloadData()}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(m.a,null,r.a.createElement("div",null,r.a.createElement("nav",null,r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(m.b,{to:"/"+window.location.search},"Home")),this.state.forms.map((function(e,t){return r.a.createElement("li",{key:t},r.a.createElement(m.b,{to:e.path+window.location.search},e.label))})))),r.a.createElement(d.c,null,this.state.forms.map((function(e,t){return r.a.createElement(d.a,{key:t,path:e.path},(function(){return r.a.createElement(M,{url:e.url+window.location.search})}))}))))))}}]),n}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(B,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},60:function(e,t,n){},87:function(e,t,n){e.exports=n(119)},92:function(e,t,n){}},[[87,1,2]]]);
//# sourceMappingURL=main.696b67db.chunk.js.map